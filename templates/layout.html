<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}EmbyPulse{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* 字体优化 */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        /* 滚动条美化 */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: #e5e7eb; border-radius: 3px; }
        ::-webkit-scrollbar-track { background: transparent; }
    </style>
    {% block head %}{% endblock %}
</head>
<body class="bg-gray-100 text-gray-800">

    <aside class="hidden md:flex flex-col w-64 h-screen fixed left-0 top-0 bg-white border-r border-gray-200 z-50">
        <div class="p-6 border-b border-gray-100 flex items-center gap-3">
            <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-emerald-400 to-blue-500 flex items-center justify-center text-white font-bold text-lg shadow-md">P</div>
            <div class="font-extrabold text-xl tracking-tight text-gray-800">EmbyPulse</div>
            <span class="text-[10px] px-2 py-0.5 bg-gray-100 text-gray-500 rounded ml-auto font-mono">
                {% if user and user.is_admin %}ADMIN{% else %}USER{% endif %}
            </span>
        </div>

        <nav class="flex-1 overflow-y-auto p-4 space-y-1">
            <div class="px-3 mb-2 text-xs font-bold text-gray-400 uppercase tracking-wider">
                {% if user and user.is_admin %}Console{% else %}My Space{% endif %}
            </div>
            
            <a href="/" class="flex items-center gap-3 px-4 py-3 rounded-xl transition-colors font-medium text-sm {% if active_page == 'dashboard' %}bg-emerald-50 text-emerald-600 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="fa-solid fa-chart-line w-5 text-center"></i> 仪表盘
            </a>
            <a href="/content" class="flex items-center gap-3 px-4 py-3 rounded-xl transition-colors font-medium text-sm {% if active_page == 'content' %}bg-emerald-50 text-emerald-600 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="fa-solid fa-trophy w-5 text-center"></i> 内容排行
            </a>
            <a href="/details" class="flex items-center gap-3 px-4 py-3 rounded-xl transition-colors font-medium text-sm {% if active_page == 'details' %}bg-emerald-50 text-emerald-600 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="fa-solid fa-magnifying-glass-chart w-5 text-center"></i> 数据洞察
            </a>

            <div class="px-3 mt-6 mb-2 text-xs font-bold text-gray-400 uppercase tracking-wider">Tools</div>
            
            <a href="/report" class="flex items-center gap-3 px-4 py-3 rounded-xl transition-colors font-medium text-sm {% if active_page == 'report' %}bg-emerald-50 text-emerald-600 font-bold{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="fa-solid fa-wand-magic-sparkles w-5 text-center"></i> 映迹工坊
            </a>
        </nav>

        <div class="p-4 border-t border-gray-100">
            <button onclick="logout()" class="w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-50 text-red-500 hover:bg-red-100 rounded-lg text-sm font-bold transition-colors">
                <i class="fa-solid fa-right-from-bracket"></i> 退出登录
            </button>
        </div>
    </aside>

    <main class="md:ml-64 min-h-screen">
        {% block content %}{% endblock %}
    </main>

    {% block scripts %}{% endblock %}
    <script>
        async function logout() {
            if(confirm('确定要退出登录吗？')) {
                try {
                    await fetch('/api/auth/logout', { method: 'POST' });
                    window.location.href = '/login';
                } catch(e) { alert('注销失败'); }
            }
        }
    </script>
</body>
</html>